# Замена авторизации с табельного номера на ИИН
## Дата: 2025-06-08

### Выполненные изменения:

1. **Клиентская часть (Frontend)**:
   - Обновлена форма входа в `index.html` - изменены тексты с "Табельный номер" на "ИИН"
   - Добавлена HTML5 валидация для ИИН (pattern="\d{12}", maxlength="12")
   - Обновлен placeholder на примере ИИН: 951026301078
   - В `app.js` добавлена JavaScript валидация ИИН (проверка на 12 цифр)
   - Обновлена логика авторизации для отправки ИИН вместо табельного номера
   - Сохранена поддержка админ-входа через пароль admin12qw
   - Обновлены формы Telegram привязки для работы с ИИН

2. **Серверная часть (Backend)**:
   - Обновлен `/api/login` эндпоинт в `backend/routes/auth.js`:
     - Добавлена поддержка параметра `iin` 
     - Сохранена обратная совместимость с `tableNumber`
     - Добавлена валидация ИИН на сервере
     - Поиск в БД теперь происходит по полю `iin`
   - Обновлены Telegram эндпоинты в `backend/routes/telegram.js`:
     - `/api/telegram/link` теперь принимает `employeeIIN`
     - Добавлена колонка `employee_iin` в таблицу `users`
     - Обновлены SQL запросы для работы с ИИН

3. **База данных**:
   - Добавлена колонка `employee_iin VARCHAR(12)` в таблицу `users`
   - Добавлен уникальный индекс на `employee_iin`
   - Проверено наличие колонки `iin` в таблице `employees`

4. **Документация**:
   - Обновлен файл `CLAUDE.md` с новой информацией об авторизации
   - Добавлены тестовые ИИН для проверки

### Тестирование:
1. Успешная авторизация по ИИН: 951026301058
2. Успешная авторизация админа: admin12qw
3. Валидация ИИН работает корректно (отклоняет невалидные форматы)

### Важные заметки:
- Старые эндпоинты сохранены для обратной совместимости
- Админ-доступ остается через пароль admin12qw
- Telegram привязка теперь работает через ИИН
- ИИН валидируется как на клиенте, так и на сервере (12 цифр)